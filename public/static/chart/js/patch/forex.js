xh5_define("patch.forex",["utils.util","cfgs.settinger"],function(t,e){var n=t.dateUtil,a=t.$C;return function(){function i(t){function i(){var t,e,i=150,s="border:0;font-size:100%;font:inherit;vertical-align:baseline;margin:0;padding:0;border-collapse:collapse;border-spacing:0;",o="text-align:left;font-weight:normal;",d="text-align:right;",p=a("div"),h=p.style;h.position="absolute",h.zIndex=r.PARAM.I_Z_INDEX-1,h.padding="2px",h.width=i+"px",h.lineHeight="16px",h.display="none",h.fontSize="12px";var c,f,u,v,g=a("table"),y=a("thead"),C=a("tbody");g.style.cssText=s,y.style.textAlign="center",c=a("tr"),f=a("th"),f.setAttribute("colspan","2"),f.style.fontWeight="normal";var b=a("span");f.appendChild(b),c.appendChild(f),y.appendChild(c),c=a("tr"),c.style.textAlign="center",f=a("th"),f.setAttribute("colspan","2"),f.style.fontWeight="normal";var m=a("span");f.appendChild(m),c.appendChild(f),C.appendChild(c),c=a("tr"),f=a("th"),f.style.cssText=o,u=a("td"),v=a("span"),v.innerHTML="\u4ef7\u683c";var x=a("span");u.style.cssText=d,f.appendChild(v),u.appendChild(x),c.appendChild(f),c.appendChild(u),C.appendChild(c),c=a("tr"),f=a("th"),f.style.cssText=o,u=a("td"),v=a("span"),v.innerHTML="\u6da8\u8dcc";var T=a("span");u.style.cssText=d,f.appendChild(v),u.appendChild(T),c.appendChild(f),c.appendChild(u),C.appendChild(c),g.appendChild(y),g.appendChild(C),g.style.width="100%",p.appendChild(g);var I,H=function(t,e){var n=r.COLOR.F_N;return t>e?n=r.COLOR.F_RISE:e>t&&(n=r.COLOR.F_FALL),n};this.setFloaterData=function(a){if(t=a.name||t||"",b.innerHTML=t,I=a.data||e){e=I;var i=I.close,r=I.prevclose,s=(i-r)/r;m.innerHTML=n.ds(I.date,"/")+"/"+n.nw(I.date.getDay())+(I.time||"");var o=1>r?4:l;x.innerHTML=i.toFixed(o),T.innerHTML=I.change.toFixed(o)+"("+(100*s).toFixed(o)+"%)",T.style.color=H(s,0),x.style.color=H(i,r)}},this.body=p,this.reset=function(){t=null,e=null}}var r=e.getSetting(t.chart.getChartId(),!0),l=isNaN(t.nfloat)?2:t.nfloat;return i}this.VER="1.1.3";var r=function(e){var n,a,i=e.o,r=e.cb,l=i.symbol,s=i.timeSymbol||"sys_time",o=i.offset||-1,d=0==location.protocol.indexOf("https:");KKE.api("datas.hq.get",{symbol:[l,s].join(","),cancelEtag:!0,ssl:d},function(e){for(var i=e.data.length;i--;){if(e.data[i].symbol==l){n=e.data[i];break}}for(var d=e.data.length;d--;){if(e.data[d].symbol==s){a=e.data[d];break}}if(n&&n.date&&a){var p=a.date||new Date(1000*a.hqstr),h=60*p.getTimezoneOffset()*1000;p.setTime(p.getTime()+h),p.setHours(p.getHours()+8);var c,f=p.getDay(),u="DINIW"==l?6:7;if(6==f){if(c=p.getHours(),c>=u){return}}else{if(0==f){return}if(1==f&&(c=p.getHours(),u>c)){return}}o>=0&&p.setSeconds(-o);var v=t.dateUtil.ddt(n.date);if(v>=p){return void (t.isFunc(r)&&r(null))}var g=t.dateUtil.dss(p),y=g.split(" "),C=n.hqstr,b=C.split(",");b[0]=y[1];var m=/^(DINIW|USDCNY)/.test(l)?10:17;b[m]=y[0],KKE.api("datas.hq.parse",{symbol:l,hqStr:b.join(",")},function(e){t.isFunc(r)&&r(e.data[0].hqstr)})}})},l=[],s=30,o=function(){for(var t=l.length;t--;){clearInterval(l[t].i)}},d=function(){for(var t,e=l.length;e--;){t=l[e],t.i=setInterval(r,1000*s,t)}};this.newhqtime=function(t,e){var n={o:t,cb:e,i:0/0};r(n),s=isNaN(t.interval)?s:t.interval,s>0&&(o(),l.push(n),d())},this.removeAll=function(){for(;l.length;){var t=l.pop();clearInterval(t.i)}},this.removeBySymbol=function(t){for(var e,n=t.symbol,a=l.length;a--;){if(e=l[a],e.o.symbol==n){clearInterval(e.i),l.splice(a,1);break}}},this.customfloater=function(t,e){var n={vid_1:new i(t)};e(n)}}});